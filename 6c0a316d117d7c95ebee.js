var io,popupLogin=document.getElementById("popupLogin"),popupSignIn=document.getElementById("popupSignIn"),nicknameForm=document.getElementById("nickname"),socketio=require("socket.io-client");function login(e,n){(io=socketio.io("https://unovinci.webpubsub.azure.com",{path:"/clients/socketio/hubs/hub"})).on("connected",(()=>{io.emit("login",{email:e,password:n})})),io.on("loginResult",(n=>{var{username:t}=n;void 0!==t?(console.log("Connexion réussie pour ".concat(e)),popupLogin.style.display="none",document.getElementById("loginSubmitError").innerText="",document.getElementById("nickname").addEventListener("keydown",blockKeyboardInput),document.getElementById("signInPath").style.display="none",document.getElementById("loginPath").style.display="none",nicknameForm.value=t):(console.log("Échec de la connexion"),document.getElementById("loginSubmitError").innerText="email ou mot de passe incorrect"),io.disconnect(),io=null})),setTimeout((()=>{null!==io&&(io.disconnect(),io=null,console.log("Échec de la connexion"))}),2e3)}function signIn(e,n,t){(io=socketio.io("https://unovinci.webpubsub.azure.com",{path:"/clients/socketio/hubs/hub"})).on("connected",(()=>{io.emit("register",{email:e,pseudo:n,password:t})})),io.on("signInResult",(n=>{var{username:t}=n;void 0!==t?(console.log("Inscription réussie pour ".concat(e)),nicknameForm.value=t,document.getElementById("nickname").addEventListener("keydown",blockKeyboardInput),popupSignIn.style.display="none",document.getElementById("signInPath").style.display="none",document.getElementById("loginPath").style.display="none",document.getElementById("signInSubmitError").innerText=""):(console.log("Échec de l'inscription"),document.getElementById("signInSubmitError").innerText="Adresse mail déjà existante"),io.disconnect(),io=null})),setTimeout((()=>{null!==io&&(io.disconnect(),io=null,console.log("Échec de la connexion"))}),2e3)}function blockKeyboardInput(e){e.preventDefault()}document.getElementById("signInForm").addEventListener("submit",(e=>{e.preventDefault();var n=!0,t=document.getElementById("nicknameSignIn").value;""===t.trim()?(document.getElementById("signInNicknameError").innerText="Le pseudo est requis",n=!1):document.getElementById("signInNicknameError").innerText="";var o=document.getElementById("emailSignIn").value;""===o.trim()?(document.getElementById("signInEmailError").innerText="L'email est requis",n=!1):document.getElementById("signInEmailError").innerText="";var i=document.getElementById("passwordSignIn").value;""===i.trim()?(document.getElementById("signInPasswordError").innerText="Le mot de passe est requis",n=!1):document.getElementById("signInPasswordError").innerText="";var r=document.getElementById("passwordConfirmation").value;""===r.trim()||r!==i?(document.getElementById("signInConfirmPasswordError").innerText="Les mots de passe ne correspondent pas",n=!1):document.getElementById("signInConfirmPasswordError").innerText="",!1===document.getElementById("conditionsUtilisation").checked?(document.getElementById("signInCUError").innerText="Veuillez confirmer les conditions d'utilisation",n=!1):document.getElementById("signInCUError").innerText="",n&&signIn(o,t,i)})),document.getElementById("loginForm").addEventListener("submit",(e=>{e.preventDefault();var n=!0,t=document.getElementById("emailLogin").value;""===t.trim()?(document.getElementById("loginEmailError").innerText="L'email est requis",n=!1):document.getElementById("loginEmailError").innerText="";var o=document.getElementById("passwordLogin").value;""===o.trim()?(document.getElementById("loginPasswordError").innerText="Le mot de passe est requis",n=!1):document.getElementById("loginPasswordError").innerText="",n&&login(t,o)}));